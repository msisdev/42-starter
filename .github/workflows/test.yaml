# .github/workflows/build.yaml
name: test
on: [push, pull_request]

jobs:
  job-test-ex00:
    runs-on: ubuntu-latest
    name: Test ex00
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: make ex00
      working-directory: ./ex00
      run: make fclean && make test

    - name: make test
      working-directory: ./ex00
      # run: ls bin *_test* | xargs -L 1 -d '\n'
      run: |
        BIN_DIR="./bin"

        find "$BIN_DIR" -type f -name '*_test' -executable -print0 | while IFS= read -r -d $'\0' binary_path; do
          echo "Running: $binary_path"
          "$binary_path" # Execute the binary
          if [ $? -ne 0 ]; then
            echo "Error running $binary_path"
            exit 1 # Exit if a binary fails
          fi
        done
